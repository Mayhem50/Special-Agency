<link rel="import" href="../../../../bower_components/neon-animation/neon-shared-element-animatable-behavior.html">
<link rel="import" href="../../../../bower_components/google-map/google-map.html" />
<link rel="import" href="../../../../bower_components/paper-dropdown-menu/paper-dropdown-menu.html">

<link rel="import" href="../../../../bower_components/pk-datepicker/pk-datepicker.html" />

<dom-module id="sa-mission-creation-card">
    <style>
        :host {
            color: #feffff;
            --paper-input-container-label : {                    
                    color: #cccccc;
            }
            --paper-input-container-input-color: #cccccc;
            --paper-input-container-underline-focus: {
                background: rgba(20, 20, 20, 0.97);
            }
            --paper-menu-button-dropdown-background:rgba(0, 0, 0, 0.2);
        }

        paper-card {
            width: 100%;
            background-image: url(../../images/missions/01.jpg);
            background-position: 50% 0%;
            background-repeat: no-repeat;
        }

        .header {
            height: 300px;
            background-color: rgba(9, 9, 9, 0.23);
            display: flex;
            justify-content: flex-start;
            flex-flow: column;
            justify-content: flex-end;
        }

            .header > * {
                width: 75%;
            }

            .header > paper-input {
                margin: 1px 25px 10px 25px;
                border: solid 1px;
                border-radius: 5px;
                font-size: 16px;
                height: 40px;
                padding: 2px 15px;
                background-color: rgba(0, 0, 0, 0.52);
                color: #cccccc;
                border-color: rgba(82, 82, 82, 0.90);
            }
            
            .header > paper-dropdown-menu{
                margin: 1px 25px 10px 25px;
                border: solid 1px;
                border-radius: 5px;
                font-size: 16px;
                height: 40px;
                padding: 2px 15px;
                background-color: rgba(0, 0, 0, 0.52);
                color: #cccccc;
                border-color: rgba(82, 82, 82, 0.90);
            }

            paper-item {
                background-color:rgba(0, 0, 0, 0.2);
                color: #cccccc;
            }

            paper-material{
                background-color:rgba(0, 0, 0, 0.00);
            }

        .middle {
            height: 48px;
            background-color: #333333;
            flex-direction: row;
            display: flex;
            justify-content: flex-start;
            align-items: center;
        }

            .middle > div {
                margin-left: 10px;
            }

        .footer {
            height: 85px;
            background-color: #2d2d2d;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        paper-button {
            background-color: #0593d3;
            text-transform: none;
            font-family: 'Segoe UI';
            font-size: 22px;
            font-weight: 100;
            width: 90%;
        }
    </style>
    <template>
        <paper-card>
            <div class="header">
                <paper-input always-float-label="false" no-label-float="true" id="title" is="iron-input" label="Title" name="title" value="{{_title::input}}"></paper-input>
                
                <paper-dropdown-menu always-float-label="false" no-label-float="true" label="[[kind.name.en]]">
                    <div class="dropdown-content">
                        <template is="dom-repeat" items="[[kinds]]">
                            <paper-item on-click="_selectKind">[[item.name.en]]</paper-item>
                        </template>
                    </div>
                </paper-dropdown-menu>
                <paper-input always-float-label="false" no-label-float="true" id="reward" is="iron-input" type="number" min="0" label="Reward" name="reward" value="{{_reward::input}}"></paper-input>
            </div>

            <div class="middle">
                <div style="color:#808080">Missions created: </div><div style="color:#cccccc">[[count]]</div>
            </div>

            <div class="footer paper-card-action">
                <paper-button on-tap="_openCreateMissionDialog">Create a Mission</paper-button>
            </div>
        </paper-card>
    </template>

    <script>
        (function () {
            Polymer({
                is: 'sa-mission-creation-card',

                properties: {
                    count: Number,
                    kinds: {
                        type: Array,
                        observer: "kindsChange"
                    },
                    ajax_params: {
                        type: Object,
                        value: function () {
                            return {
                                access_token: ''
                            }
                        }
                    },
                    kindLabel: {
                        type: String,
                        value: "Kind"
                    },
                    kind: Object
                },
                _selectKind: function (e) {
                    this._updateSelectedKind(e.target._templateInstance.item);
                    this.querySelector('paper-dropdown-menu').close();
                },
                _openMenu: function (e) {
                    this.querySelector('paper-dropdown-menu').open();
                },
                _openCreateMissionDialog: function (e) {
                    this.fire('create-mission', {
                        "title": this._title,
                        "kind": this.kind,
                        "reward": this._reward
                    })
                },
                kindsChange: function(e){
                    if (this.kinds.length > 0) {
                        this._updateSelectedKind(this.kinds[0]);
                    }
                },
                _updateSelectedKind: function (kind) {
                    this.set('kind', kind);
                    this.kind.name.en = this.kind.name.en.replace(/^./, this.kind.name.en[0].toUpperCase());
                    this.kind.name.fr = this.kind.name.fr.replace(/^./, this.kind.name.fr[0].toUpperCase());

                    this.fire('kind-change', { kind: this.kind });
                }
            });
        })();
    </script>
</dom-module>
