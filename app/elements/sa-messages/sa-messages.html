
<link rel="import" href="../sa-chats/sa-chats-list.html" />
<link rel="import" href="../sa-chats/sa-chat-box.html" />
<link rel="import" href="../sa-missions/sa-mission-card.html" />
<link rel="import" href="../sa-xhr/sa-xhr.html" />

<dom-module id="sa-messages">
    <style>
        :host {
            display:flex;
            margin-top: 15px;
            justify-content:space-around;
            --sa-mission-card:{
                margin:0;
            }
            --sa-chat-box:{
                width:600px;
            }
        }

        #messages-list{
            display:flex;
            flex-direction:column;
            justify-content:space-between;
        }

        sa-chat-box{
        }
    </style>
    <template>
        <div id="messages-list">
            <sa-chats-list id="chats" user-role="[[role]]" on-chat-selected="_updateChat"></sa-chats-list>
        </div>
        <sa-chat-box chat="[[_currentChat]]" mission="[[_currentChat._mission]]"></sa-chat-box>
        <sa-mission-card mission="[[_currentChat._mission]]"
                         hide
                         show-level></sa-mission-card>
    </template>

    <script>
        (function () {
            Polymer({
                is: 'sa-messages',
                properties: {
                    role: {
                        type: String,
                        value: 'agent'
                    },
                    _currentChat:Object
                },
                ready: function (e) {
                    app.addEventListener('role-changed', function (e) {
                        this.role = app.role;
                    }.bind(this));

                    app.addEventListener('route-changed', function (e) {
                        this._currentChat = app.currentChat;
                    }.bind(this));
                },
                _updateChat: function (e) {
                    this._currentChat = e.detail.chat;
                }
            });
        })();

    </script>
</dom-module>

